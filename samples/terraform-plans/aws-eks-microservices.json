{
  "format_version": "1.2",
  "terraform_version": "1.6.0",
  "planned_values": {},
  "resource_changes": [
    {
      "address": "aws_vpc.eks",
      "type": "aws_vpc",
      "name": "eks",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "mode": "managed",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "cidr_block": "10.0.0.0/16",
          "enable_dns_hostnames": true,
          "enable_dns_support": true,
          "tags": { "Name": "eks-vpc", "kubernetes.io/cluster/microservices": "shared" }
        }
      }
    },
    {
      "address": "aws_subnet.private_1",
      "type": "aws_subnet",
      "name": "private_1",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "mode": "managed",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "vpc_id": "aws_vpc.eks.id",
          "cidr_block": "10.0.1.0/24",
          "availability_zone": "us-west-2a",
          "tags": { "Name": "eks-private-1", "kubernetes.io/role/internal-elb": "1" }
        }
      }
    },
    {
      "address": "aws_subnet.private_2",
      "type": "aws_subnet",
      "name": "private_2",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "mode": "managed",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "vpc_id": "aws_vpc.eks.id",
          "cidr_block": "10.0.2.0/24",
          "availability_zone": "us-west-2b",
          "tags": { "Name": "eks-private-2", "kubernetes.io/role/internal-elb": "1" }
        }
      }
    },
    {
      "address": "aws_subnet.private_3",
      "type": "aws_subnet",
      "name": "private_3",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "mode": "managed",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "vpc_id": "aws_vpc.eks.id",
          "cidr_block": "10.0.3.0/24",
          "availability_zone": "us-west-2c",
          "tags": { "Name": "eks-private-3", "kubernetes.io/role/internal-elb": "1" }
        }
      }
    },
    {
      "address": "aws_subnet.public_1",
      "type": "aws_subnet",
      "name": "public_1",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "mode": "managed",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "vpc_id": "aws_vpc.eks.id",
          "cidr_block": "10.0.101.0/24",
          "availability_zone": "us-west-2a",
          "map_public_ip_on_launch": true,
          "tags": { "Name": "eks-public-1", "kubernetes.io/role/elb": "1" }
        }
      }
    },
    {
      "address": "aws_subnet.public_2",
      "type": "aws_subnet",
      "name": "public_2",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "mode": "managed",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "vpc_id": "aws_vpc.eks.id",
          "cidr_block": "10.0.102.0/24",
          "availability_zone": "us-west-2b",
          "map_public_ip_on_launch": true,
          "tags": { "Name": "eks-public-2", "kubernetes.io/role/elb": "1" }
        }
      }
    },
    {
      "address": "aws_internet_gateway.eks",
      "type": "aws_internet_gateway",
      "name": "eks",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "mode": "managed",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "vpc_id": "aws_vpc.eks.id",
          "tags": { "Name": "eks-igw" }
        }
      }
    },
    {
      "address": "aws_nat_gateway.eks_1",
      "type": "aws_nat_gateway",
      "name": "eks_1",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "mode": "managed",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "subnet_id": "aws_subnet.public_1.id",
          "tags": { "Name": "eks-nat-1" }
        }
      }
    },
    {
      "address": "aws_nat_gateway.eks_2",
      "type": "aws_nat_gateway",
      "name": "eks_2",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "mode": "managed",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "subnet_id": "aws_subnet.public_2.id",
          "tags": { "Name": "eks-nat-2" }
        }
      }
    },
    {
      "address": "aws_security_group.eks_cluster",
      "type": "aws_security_group",
      "name": "eks_cluster",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "mode": "managed",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "vpc_id": "aws_vpc.eks.id",
          "name": "eks-cluster-sg",
          "description": "EKS cluster security group",
          "tags": { "Name": "eks-cluster-sg" }
        }
      }
    },
    {
      "address": "aws_security_group.eks_nodes",
      "type": "aws_security_group",
      "name": "eks_nodes",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "mode": "managed",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "vpc_id": "aws_vpc.eks.id",
          "name": "eks-nodes-sg",
          "description": "EKS worker nodes security group",
          "tags": { "Name": "eks-nodes-sg" }
        }
      }
    },
    {
      "address": "aws_eks_cluster.main",
      "type": "aws_eks_cluster",
      "name": "main",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "mode": "managed",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "name": "microservices-cluster",
          "version": "1.28",
          "role_arn": "arn:aws:iam::123456789:role/eks-cluster-role",
          "vpc_config": {
            "subnet_ids": ["subnet-1", "subnet-2", "subnet-3"],
            "security_group_ids": ["sg-cluster"]
          },
          "tags": { "Name": "microservices-eks" }
        }
      }
    },
    {
      "address": "aws_lb.ingress",
      "type": "aws_lb",
      "name": "ingress",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "mode": "managed",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "name": "microservices-ingress-alb",
          "load_balancer_type": "application",
          "internal": false,
          "subnets": ["aws_subnet.public_1.id", "aws_subnet.public_2.id"],
          "tags": { "Name": "ingress-alb" }
        }
      }
    },
    {
      "address": "aws_lb.internal",
      "type": "aws_lb",
      "name": "internal",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "mode": "managed",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "name": "microservices-internal-nlb",
          "load_balancer_type": "network",
          "internal": true,
          "subnets": ["aws_subnet.private_1.id", "aws_subnet.private_2.id"],
          "tags": { "Name": "internal-nlb" }
        }
      }
    },
    {
      "address": "aws_rds_cluster.aurora",
      "type": "aws_rds_cluster",
      "name": "aurora",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "mode": "managed",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "cluster_identifier": "microservices-aurora",
          "engine": "aurora-postgresql",
          "engine_version": "15.4",
          "database_name": "microservices",
          "master_username": "admin",
          "serverlessv2_scaling_configuration": {
            "min_capacity": 0.5,
            "max_capacity": 16
          },
          "tags": { "Name": "aurora-serverless" }
        }
      }
    },
    {
      "address": "aws_dynamodb_table.orders",
      "type": "aws_dynamodb_table",
      "name": "orders",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "mode": "managed",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "name": "orders-table",
          "billing_mode": "PAY_PER_REQUEST",
          "hash_key": "orderId",
          "range_key": "timestamp",
          "tags": { "Name": "orders-dynamodb" }
        }
      }
    },
    {
      "address": "aws_dynamodb_table.inventory",
      "type": "aws_dynamodb_table",
      "name": "inventory",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "mode": "managed",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "name": "inventory-table",
          "billing_mode": "PAY_PER_REQUEST",
          "hash_key": "productId",
          "tags": { "Name": "inventory-dynamodb" }
        }
      }
    },
    {
      "address": "aws_elasticache_cluster.redis",
      "type": "aws_elasticache_cluster",
      "name": "redis",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "mode": "managed",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "cluster_id": "microservices-cache",
          "engine": "redis",
          "engine_version": "7.0",
          "node_type": "cache.r6g.large",
          "num_cache_nodes": 3,
          "tags": { "Name": "redis-cluster" }
        }
      }
    },
    {
      "address": "aws_s3_bucket.artifacts",
      "type": "aws_s3_bucket",
      "name": "artifacts",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "mode": "managed",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "bucket": "microservices-artifacts",
          "tags": { "Name": "build-artifacts" }
        }
      }
    },
    {
      "address": "aws_s3_bucket.logs",
      "type": "aws_s3_bucket",
      "name": "logs",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "mode": "managed",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "bucket": "microservices-logs",
          "tags": { "Name": "application-logs" }
        }
      }
    },
    {
      "address": "aws_efs_file_system.shared",
      "type": "aws_efs_file_system",
      "name": "shared",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "mode": "managed",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "performance_mode": "generalPurpose",
          "throughput_mode": "elastic",
          "encrypted": true,
          "tags": { "Name": "shared-efs" }
        }
      }
    },
    {
      "address": "aws_lambda_function.authorizer",
      "type": "aws_lambda_function",
      "name": "authorizer",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "mode": "managed",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "function_name": "api-authorizer",
          "runtime": "nodejs20.x",
          "handler": "index.handler",
          "memory_size": 256,
          "timeout": 10,
          "tags": { "Name": "authorizer-lambda" }
        }
      }
    },
    {
      "address": "aws_lambda_function.event_processor",
      "type": "aws_lambda_function",
      "name": "event_processor",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "mode": "managed",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "function_name": "event-processor",
          "runtime": "python3.11",
          "handler": "main.handler",
          "memory_size": 512,
          "timeout": 60,
          "tags": { "Name": "event-processor-lambda" }
        }
      }
    },
    {
      "address": "aws_lambda_function.notification",
      "type": "aws_lambda_function",
      "name": "notification",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "mode": "managed",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "function_name": "notification-service",
          "runtime": "nodejs20.x",
          "handler": "index.handler",
          "memory_size": 256,
          "timeout": 30,
          "tags": { "Name": "notification-lambda" }
        }
      }
    },
    {
      "address": "aws_vpc_endpoint.s3",
      "type": "aws_vpc_endpoint",
      "name": "s3",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "mode": "managed",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "vpc_id": "aws_vpc.eks.id",
          "service_name": "com.amazonaws.us-west-2.s3",
          "vpc_endpoint_type": "Gateway",
          "tags": { "Name": "s3-endpoint" }
        }
      }
    },
    {
      "address": "aws_vpc_endpoint.ecr_api",
      "type": "aws_vpc_endpoint",
      "name": "ecr_api",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "mode": "managed",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "vpc_id": "aws_vpc.eks.id",
          "service_name": "com.amazonaws.us-west-2.ecr.api",
          "vpc_endpoint_type": "Interface",
          "private_dns_enabled": true,
          "tags": { "Name": "ecr-api-endpoint" }
        }
      }
    },
    {
      "address": "aws_vpc_endpoint.ecr_dkr",
      "type": "aws_vpc_endpoint",
      "name": "ecr_dkr",
      "provider_name": "registry.terraform.io/hashicorp/aws",
      "mode": "managed",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "vpc_id": "aws_vpc.eks.id",
          "service_name": "com.amazonaws.us-west-2.ecr.dkr",
          "vpc_endpoint_type": "Interface",
          "private_dns_enabled": true,
          "tags": { "Name": "ecr-dkr-endpoint" }
        }
      }
    }
  ]
}
